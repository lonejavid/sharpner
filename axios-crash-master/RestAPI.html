<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add Bill</title>
</head>
<body>
  <h2>Add Bill</h2>

  <!-- Order Form -->
  <form id="order-form">
    <label for="dish-price">Choose Price:</label><br>
    <input type="number" id="dish-price" name="dish-price"><br><br>

    <label for="dish-name">Choose Dish:</label><br>
    <input type="text" id="dish-name" name="dish-name"><br><br>

    <label for="table">Choose Table:</label><br>
    <select id="table" name="table">
      <option value="TABLE1">Table 1</option>
      <option value="TABLE2">Table 2</option>
      <option value="TABLE3">Table 3</option>
    </select><br><br>

    <button type="button" onclick="addBill()">Add Bill</button>
  </form>

  <!-- Display Orders for TABLE1 -->
  <div id="table1-orders">
    <h3>Orders for Table 1</h3>
    <!-- This div will contain orders for Table 1 -->
  </div>

  <!-- Display Orders for TABLE2 -->
  <div id="table2-orders">
    <h3>Orders for Table 2</h3>
    <!-- This div will contain orders for Table 2 -->
  </div>

  <!-- Display Orders for TABLE3 -->
  <div id="table3-orders">
    <h3>Orders for Table 3</h3>
    <!-- This div will contain orders for Table 3 -->
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>
  <script>
    function addBill() {
      const dishPrice = document.getElementById('dish-price').value;
      const dishName = document.getElementById('dish-name').value;
      const table = document.getElementById('table').value;

      const data = {
        "dishPrice": dishPrice,
        "dishName": dishName
      };

      axios.post(`https://crudcrud.com/api/cc7020c0aaf744229b367027879df75c/orders_${table}`, data)
        .then(response => {
          // After successful addition, fetch and display orders for the selected table
          displayOrders(table);
        })
        .catch(error => {
          console.error('Error adding bill:', error);
        });
    }

    function displayOrders(table) {
      axios.get(`https://crudcrud.com/api/cc7020c0aaf744229b367027879df75c/orders_${table}`)
        .then(response => {
          const orders = response.data;
          const ordersListDiv = document.getElementById(`${table.toLowerCase()}-orders`);
          ordersListDiv.innerHTML = ''; // Clear existing orders

          // Create a container for orders
          const tableContainer = document.createElement('div');
          tableContainer.classList.add('table-container');

          const tableHeading = document.createElement('h3');
          tableHeading.textContent = `Orders for ${table}`;
          tableContainer.appendChild(tableHeading);

          orders.forEach(order => {
            const orderInfo = `Dish: ${order.dishName}, Price: ${order.dishPrice}`;
            const orderElement = document.createElement('p');
            orderElement.textContent = orderInfo;

            // Create a delete button for each order
            const deleteButton = document.createElement('button');
            deleteButton.textContent = 'Delete';
            deleteButton.onclick = () => deleteOrder(order._id, table);

            orderElement.appendChild(deleteButton);
            tableContainer.appendChild(orderElement);
          });

          ordersListDiv.appendChild(tableContainer);
        })
        .catch(error => {
          console.error(`Error fetching orders for ${table}:`, error);
        });
    }

    function deleteOrder(orderId, table) {
      axios.delete(`https://crudcrud.com/api/cc7020c0aaf744229b367027879df75c/orders_${table}/${orderId}`)
        .then(response => {
          console.log(`Order ${orderId} deleted from ${table}`);
          displayOrders(table); // Refresh the displayed list after deletion
        })
        .catch(error => {
          console.error(`Error deleting order ${orderId} from ${table}:`, error);
        });
    }

    // Display orders for each table initially when the page loads
    displayOrders('TABLE1');
    displayOrders('TABLE2');
    displayOrders('TABLE3');
  </script>
</body>
</html>
